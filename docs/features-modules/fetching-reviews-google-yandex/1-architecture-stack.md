###Раздел 1: Комплексная Архитектура Системы и Обоснование Технологического Стека
Этот раздел представляет высокоуровневую архитектуру модуля агрегации отзывов, описывает потоки данных и обосновывает выбор ключевых технологий. Цель — создать безопасную, производительную и легко поддерживаемую систему, полностью отвечающую требованиям проекта.

##1.1. Архитектурный Обзор и Схема Потоков Данных
Предлагаемая архитектура представляет собой клиент-серверное приложение, где фронтенд (Vite + JSX) взаимодействует с легковесным бэкендом (FastAPI), который выступает в роли защищенного шлюза к внешним API и локальной базе данных.

Описание потока данных:

Планировщик задач (Cron Job): Раз в сутки, в заданное время (например, в 02:00), системный планировщик Cron запускает специализированный Python-скрипт для сбора данных. Эта операция выполняется независимо от работы веб-сервера, что гарантирует ее надежность.

Агрегация данных: Запущенный скрипт последовательно подключается к внешним API:

Google Business Profile API: Используя официальный API, скрипт запрашивает список всех отзывов для указанных филиалов компании.

Python парсер Яндекс Карт: Так как у Яндекса отсутствует официальный публичный API для получения отзывов организаций, мы реализуем простой парсер отзывов из яндекс карт @/docs/features-modules/fetching-reviews-google-yandex/yandex-parser-py.md, как на этом видео: https://youtu.be/Kcq0meWaf0A?si=laMhd0vUCciqGX13

Нормализация и дедупликация: Полученные данные из двух разных источников имеют различную структуру. Скрипт приводит их к единой, унифицированной модели данных, которая соответствует схеме локальной базы данных. Перед добавлением каждого нового отзыва система проверяет его уникальность по комбинации источника (source) и оригинального идентификатора отзыва (original_review_id), чтобы избежать дублирования информации.

Сохранение в базу данных: Новые, уникальные отзывы сохраняются в локальную однофайловую базу данных SQLite (reviews.db). В базу записывается вся необходимая информация: имя автора, URL аватара, рейтинг, текст, источник и дата публикации в формате UNIX timestamp для удобства сортировки.

Запрос от фронтенда: Когда пользователь заходит на сайт "Ритуальная служба Век" , фронтенд-приложение на React отправляет один асинхронный GET-запрос на эндпоинт бэкенда, например,

GET /api/reviews.

Ответ бэкенда: Сервер FastAPI принимает запрос, выполняет простое чтение всех записей из базы данных SQLite, применяет первичную сортировку и возвращает фронтенду массив объектов JSON со всеми отзывами.

Отображение на клиенте: Фронтенд-приложение получает данные. На время ожидания ответа от сервера пользователю отображаются анимированные "скелетоны" карточек. После получения данных React выполняет финальную сортировку в соответствии с бизнес-логикой (сначала по длине текста, затем по дате) и отрисовывает реальные карточки отзывов.

Такая архитектура решает несколько ключевых задач. Во-первых, она обеспечивает безопасность, так как все API-ключи и учетные данные хранятся исключительно на бэкенде и никогда не передаются в браузер клиента. Во-вторых, бэкенд функционирует как уровень кэширования и нормализации данных. Это критически важно, поскольку он абстрагирует фронтенд от сложностей и потенциальной нестабильности внешних API. Даже если один из внешних сервисов (Google или сторонний API для Яндекса) будет временно недоступен, сайт продолжит отображать отзывы из локальной базы данных, обеспечивая высокую отказоустойчивость и стабильный пользовательский опыт.

##1.2. Обоснование Выбора Технологического Стека
Выбор технологий продиктован требованиями к производительности, простоте развертывания и удобству разработки.

FastAPI (Бэкенд): Этот Python-фреймворк выбран по нескольким причинам. Его асинхронная природа, основанная на ASGI, обеспечивает высочайшую производительность, сравнимую с решениями на Node.js и Go, что идеально подходит для I/O-операций, таких как запросы к внешним API и базе данных. Встроенная поддержка Pydantic гарантирует строгую типизацию данных и автоматическую генерацию интерактивной документации OpenAPI (Swagger UI) и ReDoc. Это значительно упрощает тестирование и отладку API. Богатая экосистема Python предоставляет готовые библиотеки для работы с Google API (google-api-python-client), HTTP-запросов (httpx) и взаимодействия с базами данных (SQLAlchemy).

SQLite (База данных): В соответствии с запросом на использование однофайловой базы данных, SQLite является оптимальным выбором. Она не требует установки и администрирования отдельного сервера баз данных, что кардинально упрощает настройку и развертывание проекта. Все данные хранятся в одном файле (reviews.db), который легко копировать и архивировать. Для задачи хранения нескольких тысяч или даже десятков тысяч отзывов производительности SQLite более чем достаточно.

Cron Job (Планировщик): Использование системного планировщика Cron является отраслевым стандартом для выполнения периодических задач. Это надежное и проверенное временем решение, которое работает на уровне операционной системы сервера. Такой подход гарантирует, что скрипт сбора отзывов будет запускаться строго по расписанию, независимо от состояния и нагрузки на веб-приложение FastAPI.
